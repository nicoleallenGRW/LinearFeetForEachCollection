
# -*- coding: utf-8 -*-
"""
Created on Thu Aug  2 14:32:38 2018

@author: nallen
"""


# 
#

import psycopg2
import xlsxwriter
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase
from email.mime.text import MIMEText
from email.utils import formatdate
from email import encoders
from datetime import datetime



excelfile =  'MainbCount.xlsx'



#Set variables for email

emailhost = ''
emailport = ''
emailsubject = 'Collection Totals for Main'
emailmessage = '''Attached is the total number of items in each collection, the number checked out, the number "off shelf" and the amount of space needed for each collection based on the target numbers. Because target numbers have not yet been determined for graphic novels and CD Music Box sets, the calculated total of space needed is based off the number of items we currently own and not the designated target number.'''
emailfrom = 'test@test.org'
emailto = []

try:
    conn = psycopg2.connect("dbname=test user=test host=sierra-db port=test password=test sslmode=test")
except psycopg2.Error as e:
    print ("Unable to connect to database: " + str(e))
    
cursor = conn.cursor()
cursor.execute(open("MainCountB.sql","r",).read())
rows = cursor.fetchall()
conn.close()


workbook = xlsxwriter.Workbook(excelfile, {'remove_timezone': True})



worksheet = workbook.add_worksheet('Main')


worksheet.set_landscape()



percent_fmt = workbook.add_format({'num_format': '0.00%'})
eformat= workbook.add_format({'text_wrap': True, 'valign': 'center' , 'num_format': 'mm/dd/yy', 'bg_color': '#D3D3D3'})
eformat1= workbook.add_format({'text_wrap': True, 'valign': 'center' , 'num_format': 'mm/dd/yy', 'bg_color': '#D3D3D3'})
eformatlabel= workbook.add_format({'text_wrap': True, 'valign': 'top', 'bold': True})
eformatlabel1= workbook.add_format({'text_wrap': True, 'valign': 'top', 'bold': True, 'bg_color': '#D3D3D3'})
eformatlabel2= workbook.add_format({'text_wrap': True, 'align': 'right'})    
eformatlabel3= workbook.add_format({'text_wrap': True, 'align': 'right', 'bg_color': '#D3D3D3'})                                
decimal = workbook.add_format({'num_format': '0.00'})
decimal1 = workbook.add_format({'num_format': '0.00', 'bg_color': '#D3D3D3'})
decimal3 = workbook.add_format({'num_format': '0.'})
decimal4 = workbook.add_format({'num_format': '0.', 'bg_color': '#D3D3D3'})
data_format1 = workbook.add_format({'bg_color': '#D3D3D3'})

data_format2 = workbook.add_format({'bg_color': '#FFFFFF'})
data_format3 = workbook.add_format({'bg_color': '#D3D3D3', 'num_format': '0.00%'})                                    

for row in range(0, 77, 2):
    worksheet.set_row(row, cell_format=data_format1)
    worksheet.set_row(row + 1, cell_format=data_format2)
                                    
                                    
                                   
                                    
worksheet.set_column(0,0,30.29)
worksheet.set_column(1,1,10)
worksheet.set_column(2,2,10)
worksheet.set_column(3,3,11.57)
worksheet.set_column(4,4,10)
worksheet.set_column(5,5,11.57)
worksheet.set_column(6,6,11.57)
worksheet.set_column(7,7,10)
worksheet.set_column(8,8,14)
worksheet.set_column(9,9,12)
worksheet.set_column(10,10,10)
worksheet.set_column(11,11,12)
worksheet.set_column(12,12,12)


worksheet.write(0,0,'Collection', eformat)
worksheet.write(0,1,'Target', eformat)
worksheet.write(0,2,'Current Count', eformat)
worksheet.write(0,3,'Over/Under Target', eformat)
worksheet.write(0,4,'C/out', eformat)
worksheet.write(0,5,'Not Available', eformat)
worksheet.write(0,6,'Total Not on Shelf', eformat)
worksheet.write(0,7,'% not on Shelf', eformat)
worksheet.write(0,8,'Total On Shelf', eformat)
worksheet.write(0,9,'Space Needed for Target No. - % off of Shelf', eformat)
worksheet.write(0,10,'Items Per Shelf', eformat)
worksheet.write(0,11,'No. of 35" Shelves Needed', eformat)
worksheet.write(0,12,'Total Linear Feet', eformat)


worksheet.write(1,0,'000-099', eformatlabel)
worksheet.write(2,0,'004-006', eformatlabel1)
worksheet.write(3,0,'100-199', eformatlabel)
worksheet.write(4,0,'200-299', eformatlabel1)
worksheet.write(5,0,'Architecture (720-729)', eformatlabel)
worksheet.write(6,0,'Art (700-709)', eformatlabel1)
worksheet.write(7,0,'Art (730-739)', eformatlabel)
worksheet.write(8,0,'Art (750-769)', eformatlabel1)
worksheet.write(9,0,'Audiobooks', eformatlabel)
worksheet.write(10,0,'Biography Genealogy (920-929)', eformatlabel1)
worksheet.write(11,0,'Building/Technology (660-699)', eformatlabel)
worksheet.write(12,0,'Business (330-339)', eformatlabel1)
worksheet.write(13,0,'Business (650-659)', eformatlabel)
worksheet.write(14,0,'Child Rearing (649)', eformatlabel1)
worksheet.write(15,0,'Chinese', eformatlabel)
worksheet.write(16,0,'Cooking (640-642)', eformatlabel1)
worksheet.write(17,0,'Dance (793.3)', eformatlabel)
worksheet.write(18,0,'Decoration II (747-749)', eformatlabel1)
worksheet.write(19,0,'Decoration I (742 -745.4)', eformatlabel)
worksheet.write(20,0,'Education/Test Books (370-379)', eformatlabel1)
worksheet.write(21,0,'Engineering/Cars (620-629)', eformatlabel)
worksheet.write(22,0,'English/American Lit (800-829)', eformatlabel1)
worksheet.write(23,0,'Etiquette (390- 399)', eformatlabel)
worksheet.write(24,0,'Feature DVDs', eformatlabel1)
worksheet.write(25,0,'Fiction', eformatlabel)
worksheet.write(26,0,'Fiction Paperback', eformatlabel1)
worksheet.write(27,0,'Film/TV (790-791)', eformatlabel)
worksheet.write(28,0,'French', eformatlabel1)
worksheet.write(29,0,'Games (793-795 (not 793.3))', eformatlabel)
worksheet.write(30,0,'Gardening (630-635)', eformatlabel1)
worksheet.write(31,0,'General History (900-909)', eformatlabel)
worksheet.write(32,0,'German', eformatlabel1)
worksheet.write(33,0,'Graphic Novels', eformatlabel)
worksheet.write(34,0,'Handcrafts (745.5-746)', eformatlabel1)
worksheet.write(35,0,'Health (362)', eformatlabel)
worksheet.write(36,0,'Health (610-619)', eformatlabel1)
worksheet.write(37,0,'Home/Sewing (643-648 (not 647))', eformatlabel)
worksheet.write(38,0,'Illustration/Comics (740-741)', eformatlabel1)
worksheet.write(39,0,'Italian', eformatlabel)
worksheet.write(40,0,'Japanese', eformatlabel1)
worksheet.write(41,0,'Landscape Architecture (710-719)', eformatlabel)
worksheet.write(42,0,'Language Learning Audiobooks', eformatlabel1)
worksheet.write(43,0,'Language (400-499)', eformatlabel)
worksheet.write(44,0,'Large Type', eformatlabel1)
worksheet.write(45,0,'Law (340-349)', eformatlabel)
worksheet.write(46,0,'Local History (974.6)', eformatlabel1)
worksheet.write(47,0,'Music (780-789)', eformatlabel)
worksheet.write(48,0,'Music Box Sets', eformatlabel1)
worksheet.write(49,0,'Music CDs ', eformatlabel)
worksheet.write(50,0,'Music DVDs', eformatlabel1)
worksheet.write(51,0,'Music Scores', eformatlabel)
worksheet.write(52,0,'Mystery', eformatlabel1)
worksheet.write(53,0,'Mystery Paperback', eformatlabel)
worksheet.write(54,0,'New Fiction', eformatlabel1)
worksheet.write(55,0,'New Non-Fiction', eformatlabel)
worksheet.write(56,0,'Non-Fiction DVDs', eformatlabel1)
worksheet.write(57,0,'Non-Fiction Paperback', eformatlabel)
worksheet.write(58,0,'North and South American History (970-999 not 974.6)', eformatlabel1)
worksheet.write(59,0,'Patents (600-609)', eformatlabel)
worksheet.write(60,0,'Pets (636-639)', eformatlabel1)
worksheet.write(61,0,'Photography (770-779)', eformatlabel)
worksheet.write(62,0,'Political Science (320-329)', eformatlabel1)
worksheet.write(63,0,'Public Admin (350-359)', eformatlabel)
worksheet.write(64,0,'Romance Paperback', eformatlabel1)
worksheet.write(65,0,'Science (500-599)', eformatlabel)
worksheet.write(66,0,'Science Fiction', eformatlabel1)
worksheet.write(67,0,'Short Stories', eformatlabel)
worksheet.write(68,0,'Social Work/Crime (360-361, 363-369)', eformatlabel1)
worksheet.write(69,0,'Sociology (300-319)', eformatlabel)
worksheet.write(70,0,'Spanish', eformatlabel1)
worksheet.write(71,0,'Sports (796-799)', eformatlabel)
worksheet.write(72,0,'Theater (792)', eformatlabel1)
worksheet.write(73,0,'Transportation (380-389)', eformatlabel)
worksheet.write(74,0,'Travel (910-919, 647)', eformatlabel1)
worksheet.write(75,0,'World History (930-969)', eformatlabel)
worksheet.write(76,0,'World Lit (830-899)', eformatlabel1)
worksheet.write(77,0,'Young Adult', eformatlabel)



for rownum, col in enumerate(rows):
#Main Target numbers
    
    worksheet.write(rownum+1,1,'915', eformatlabel2)
    worksheet.write(rownum+2,1,'1496', eformatlabel3)
    worksheet.write(rownum+3,1,'3695', eformatlabel2)
    worksheet.write(rownum+4,1,'3166', eformatlabel3)
    worksheet.write(rownum+5,1,'2296', eformatlabel2)
    worksheet.write(rownum+6,1,'1844', eformatlabel3)
    worksheet.write(rownum+7,1,'1075', eformatlabel2)
    worksheet.write(rownum+8,1,'3014', eformatlabel3)
    worksheet.write(rownum+9,1,'7086', eformatlabel2) 
    worksheet.write(rownum+10,1,'362', eformatlabel3) 
    worksheet.write(rownum+11,1,'729', eformatlabel2)
    worksheet.write(rownum+12,1,'3030', eformatlabel3) 
    worksheet.write(rownum+13,1,'3590', eformatlabel2)     
    worksheet.write(rownum+14,1,'702', eformatlabel3)    
    worksheet.write(rownum+15,1,'1344', eformatlabel2)
    worksheet.write(rownum+16,1,'8427', eformatlabel3)
    worksheet.write(rownum+17,1,'342', eformatlabel2)
    worksheet.write(rownum+18,1,'1594', eformatlabel3)
    worksheet.write(rownum+19,1,'479', eformatlabel2) 
    worksheet.write(rownum+20,1,'2602', eformatlabel3) 
    worksheet.write(rownum+21,1,'1296', eformatlabel2)
    worksheet.write(rownum+22,1,'9869', eformatlabel3)
    worksheet.write(rownum+23,1,'1207', eformatlabel2)
    worksheet.write(rownum+24,1,'16620', eformatlabel3)
    worksheet.write(rownum+25,1,'23279', eformatlabel2)
    worksheet.write(rownum+26,1,'2545', eformatlabel3)
    worksheet.write(rownum+27,1,'1661', eformatlabel2)
    worksheet.write(rownum+28,1,'778', eformatlabel3)
    worksheet.write(rownum+29,1,'446', eformatlabel2) 
    worksheet.write(rownum+30,1,'2439', eformatlabel3) 
    worksheet.write(rownum+31,1,'354', eformatlabel2)
    worksheet.write(rownum+32,1,'192', eformatlabel3)
    worksheet.write(rownum+33,1,'', eformatlabel2)
    worksheet.write(rownum+34,1,'2823', eformatlabel3)
    worksheet.write(rownum+35,1,'838', eformatlabel2)
    worksheet.write(rownum+36,1,'6667', eformatlabel3)
    worksheet.write(rownum+37,1,'1479', eformatlabel2)
    worksheet.write(rownum+38,1,'1151', eformatlabel3)
    worksheet.write(rownum+39,1,'363', eformatlabel2) 
    worksheet.write(rownum+40,1,'6844', eformatlabel3)
    worksheet.write(rownum+41,1,'768', eformatlabel2)
    worksheet.write(rownum+42,1,'539', eformatlabel3)
    worksheet.write(rownum+43,1,'1320', eformatlabel2)
    worksheet.write(rownum+44,1,'4180', eformatlabel3)
    worksheet.write(rownum+45,1,'1136', eformatlabel2)
    worksheet.write(rownum+46,1,'685', eformatlabel3)
    worksheet.write(rownum+47,1,'3673', eformatlabel2)
    worksheet.write(rownum+48,1,'', eformatlabel3)
    worksheet.write(rownum+49,1,'26834', eformatlabel2) 
    worksheet.write(rownum+50,1,'1364', eformatlabel3)
    worksheet.write(rownum+51,1,'2165', eformatlabel2)
    worksheet.write(rownum+52,1,'7464', eformatlabel3)
    worksheet.write(rownum+53,1,'1086', eformatlabel2)
    worksheet.write(rownum+54,1,'3200', eformatlabel3)
    worksheet.write(rownum+55,1,'4965', eformatlabel2) 
    worksheet.write(rownum+56,1,'1913', eformatlabel3) 
    worksheet.write(rownum+57,1,'481', eformatlabel2)    
    worksheet.write(rownum+58,1,'5129', eformatlabel3)    
    worksheet.write(rownum+59,1,'87', eformatlabel2)   
    worksheet.write(rownum+60,1,'1057', eformatlabel3)   
    worksheet.write(rownum+61,1,'1497', eformatlabel2) 
    worksheet.write(rownum+62,1,'1103', eformatlabel3)
    worksheet.write(rownum+63,1,'557', eformatlabel2)
    worksheet.write(rownum+64,1,'1213', eformatlabel3)
    worksheet.write(rownum+65,1,'3262', eformatlabel2) 
    worksheet.write(rownum+66,1,'1226', eformatlabel3) 
    worksheet.write(rownum+67,1,'298', eformatlabel2)    
    worksheet.write(rownum+68,1,'1294', eformatlabel3)   
    worksheet.write(rownum+69,1,'3205', eformatlabel2)   
    worksheet.write(rownum+70,1,'1337', eformatlabel3)
    worksheet.write(rownum+71,1,'1823', eformatlabel2) 
    worksheet.write(rownum+72,1,'754', eformatlabel3)
    worksheet.write(rownum+73,1,'455', eformatlabel2)
    worksheet.write(rownum+74,1,'10241', eformatlabel3)
    worksheet.write(rownum+75,1,'6390', eformatlabel2)
    worksheet.write(rownum+76,1,'2066', eformatlabel3)
    worksheet.write(rownum+77,1,'9640', eformatlabel2)
    
    #MAIN Current Count
    worksheet.write(rownum+1,2,col[0])
    worksheet.write(rownum+2,2,col[1])
    worksheet.write(rownum+3,2,col[2])
    worksheet.write(rownum+4,2,col[3])
    worksheet.write(rownum+5,2,col[4])
    worksheet.write(rownum+6,2,col[5])
    worksheet.write(rownum+7,2,col[6])
    worksheet.write(rownum+8,2,col[7])
    worksheet.write(rownum+9,2,col[8]) 
    worksheet.write(rownum+10,2,col[9]) 
    worksheet.write(rownum+11,2,col[10])
    worksheet.write(rownum+12,2,col[11]) 
    worksheet.write(rownum+13,2,col[12])     
    worksheet.write(rownum+14,2,col[13])    
    worksheet.write(rownum+15,2,col[14])
    worksheet.write(rownum+16,2,col[15])
    worksheet.write(rownum+17,2,col[16])
    worksheet.write(rownum+18,2,col[17])
    worksheet.write(rownum+19,2,col[18]) 
    worksheet.write(rownum+20,2,col[19]) 
    worksheet.write(rownum+21,2,col[20])
    worksheet.write(rownum+22,2,col[21])
    worksheet.write(rownum+23,2,col[22])
    worksheet.write(rownum+24,2,col[23])
    worksheet.write(rownum+25,2,col[24])
    worksheet.write(rownum+26,2,col[25])
    worksheet.write(rownum+27,2,col[26])
    worksheet.write(rownum+28,2,col[27])
    worksheet.write(rownum+29,2,col[28]) 
    worksheet.write(rownum+30,2,col[29]) 
    worksheet.write(rownum+31,2,col[30])
    worksheet.write(rownum+32,2,col[31])
    worksheet.write(rownum+33,2,col[32])
    worksheet.write(rownum+34,2,col[33])
    worksheet.write(rownum+35,2,col[34])
    worksheet.write(rownum+36,2,col[35])
    worksheet.write(rownum+37,2,col[36])
    worksheet.write(rownum+38,2,col[37])
    worksheet.write(rownum+39,2,col[38]) 
    worksheet.write(rownum+40,2,col[39])
    worksheet.write(rownum+41,2,col[40])
    worksheet.write(rownum+42,2,col[41])
    worksheet.write(rownum+43,2,col[42])
    worksheet.write(rownum+44,2,col[43])
    worksheet.write(rownum+45,2,col[44])
    worksheet.write(rownum+46,2,col[45])
    worksheet.write(rownum+47,2,col[46])
    worksheet.write(rownum+48,2,col[47])
    worksheet.write(rownum+49,2,col[48]) 
    worksheet.write(rownum+50,2,col[49])
    worksheet.write(rownum+51,2,col[50])
    worksheet.write(rownum+52,2,col[51])
    worksheet.write(rownum+53,2,col[52])
    worksheet.write(rownum+54,2,col[53])
    worksheet.write(rownum+55,2,col[54]) 
    worksheet.write(rownum+56,2,col[55]) 
    worksheet.write(rownum+57,2,col[56])    
    worksheet.write(rownum+58,2,col[57])    
    worksheet.write(rownum+59,2,col[58])   
    worksheet.write(rownum+60,2,col[59])   
    worksheet.write(rownum+61,2,col[60]) 
    worksheet.write(rownum+62,2,col[61])
    worksheet.write(rownum+63,2,col[62])
    worksheet.write(rownum+64,2,col[63])
    worksheet.write(rownum+65,2,col[64]) 
    worksheet.write(rownum+66,2,col[65]) 
    worksheet.write(rownum+67,2,col[66])    
    worksheet.write(rownum+68,2,col[67])   
    worksheet.write(rownum+69,2,col[68])   
    worksheet.write(rownum+70,2,col[69])
    worksheet.write(rownum+71,2,col[70]) 
    worksheet.write(rownum+72,2,col[71])
    worksheet.write(rownum+73,2,col[72])
    worksheet.write(rownum+74,2,col[73])
    worksheet.write(rownum+75,2,col[74])
    worksheet.write(rownum+76,2,col[75])
    worksheet.write(rownum+77,2,col[76])    

    
    
#Over/under target
worksheet.write_formula('D2', "=C2-B2", )
worksheet.write_formula('D3', "=C3-B3", )
worksheet.write_formula('D4', "=C4-B4", )
worksheet.write_formula('D5', "=C5-B5", )
worksheet.write_formula('D6', "=C6-B6", )
worksheet.write_formula('D7', "=C7-B7", )
worksheet.write_formula('D8', "=C8-B8", )
worksheet.write_formula('D9', "=C9-B9", )
worksheet.write_formula('D10', "=C10-B10", )
worksheet.write_formula('D11', "=C11-B11", )
worksheet.write_formula('D12', "=C12-B12", )
worksheet.write_formula('D13', "=C13-B13", )
worksheet.write_formula('D14', "=C14-B14", )
worksheet.write_formula('D15', "=C15-B15", )
worksheet.write_formula('D16', "=C16-B16", )
worksheet.write_formula('D17', "=C17-B17", )
worksheet.write_formula('D18', "=C18-B18", )
worksheet.write_formula('D19', "=C19-B19", )
worksheet.write_formula('D20', "=C20-B20", )
worksheet.write_formula('D21', "=C21-B21", )
worksheet.write_formula('D22', "=C22-B22", )
worksheet.write_formula('D23', "=C23-B23", )
worksheet.write_formula('D24', "=C24-B24", )
worksheet.write_formula('D25', "=C25-B25", )
worksheet.write_formula('D26', "=C26-B26", )
worksheet.write_formula('D27', "=C27-B27", )
worksheet.write_formula('D28', "=C28-B28", )
worksheet.write_formula('D29', "=C29-B29", )
worksheet.write_formula('D30', "=C30-B30", )
worksheet.write_formula('D31', "=C31-B31", )
worksheet.write_formula('D32', "=C32-B32", )
worksheet.write_formula('D33', "=C33-B33", )
worksheet.write_formula('D34', "=C34-B34", )
worksheet.write_formula('D35', "=C35-B35", )
worksheet.write_formula('D36', "=C36-B36", )
worksheet.write_formula('D37', "=C37-B37", )
worksheet.write_formula('D38', "=C38-B38", )
worksheet.write_formula('D39', "=C39-B39", )
worksheet.write_formula('D40', "=C40-B40", )
worksheet.write_formula('D41', "=C41-B41", )
worksheet.write_formula('D42', "=C42-B42", )
worksheet.write_formula('D43', "=C43-B43", )
worksheet.write_formula('D44', "=C44-B44", )
worksheet.write_formula('D45', "=C45-B45", )
worksheet.write_formula('D46', "=C46-B46", )
worksheet.write_formula('D47', "=C47-B47", )
worksheet.write_formula('D48', "=C48-B48", )
worksheet.write_formula('D49', "=C49-B49", )
worksheet.write_formula('D50', "=C50-B50", )
worksheet.write_formula('D51', "=C51-B51", )
worksheet.write_formula('D52', "=C52-B52", )
worksheet.write_formula('D53', "=C53-B53", )
worksheet.write_formula('D54', "=C54-B54", )
worksheet.write_formula('D55', "=C55-B55", )
worksheet.write_formula('D56', "=C56-B56", )
worksheet.write_formula('D57', "=C57-B57", )
worksheet.write_formula('D58', "=C58-B58", )
worksheet.write_formula('D59', "=C59-B59", )
worksheet.write_formula('D60', "=C60-B60", )
worksheet.write_formula('D61', "=C61-B61", )
worksheet.write_formula('D62', "=C62-B62", )
worksheet.write_formula('D63', "=C63-B63", )
worksheet.write_formula('D64', "=C64-B64", )
worksheet.write_formula('D65', "=C65-B65", )
worksheet.write_formula('D66', "=C66-B66", )
worksheet.write_formula('D67', "=C67-B67", )
worksheet.write_formula('D68', "=C68-B68", )
worksheet.write_formula('D69', "=C69-B69", )
worksheet.write_formula('D70', "=C70-B70", )
worksheet.write_formula('D71', "=C71-B71", )
worksheet.write_formula('D72', "=C72-B72", )
worksheet.write_formula('D73', "=C73-B73", )
worksheet.write_formula('D74', "=C74-B74", )
worksheet.write_formula('D75', "=C75-B75", )
worksheet.write_formula('D76', "=C76-B76", )
worksheet.write_formula('D77', "=C77-B77", )
worksheet.write_formula('D78', "=C78-B78", )

#cout
    
worksheet.write(rownum+1,4,col[77])
worksheet.write(rownum+2,4,col[78])
worksheet.write(rownum+3,4,col[79])
worksheet.write(rownum+4,4,col[80])
worksheet.write(rownum+5,4,col[81])
worksheet.write(rownum+6,4,col[82])
worksheet.write(rownum+7,4,col[83])
worksheet.write(rownum+8,4,col[84])
worksheet.write(rownum+9,4,col[85])
worksheet.write(rownum+10,4,col[86])
worksheet.write(rownum+11,4,col[87])
worksheet.write(rownum+12,4,col[88])
worksheet.write(rownum+13,4,col[89])
worksheet.write(rownum+14,4,col[90])
worksheet.write(rownum+15,4,col[91])
worksheet.write(rownum+16,4,col[92])
worksheet.write(rownum+17,4,col[93])
worksheet.write(rownum+18,4,col[94])
worksheet.write(rownum+19,4,col[95])
worksheet.write(rownum+20,4,col[96])
worksheet.write(rownum+21,4,col[97])
worksheet.write(rownum+22,4,col[98])
worksheet.write(rownum+23,4,col[99])
worksheet.write(rownum+24,4,col[100])
worksheet.write(rownum+25,4,col[101])
worksheet.write(rownum+26,4,col[102])
worksheet.write(rownum+27,4,col[103])
worksheet.write(rownum+28,4,col[104])
worksheet.write(rownum+29,4,col[105])
worksheet.write(rownum+30,4,col[106])
worksheet.write(rownum+31,4,col[107])
worksheet.write(rownum+32,4,col[108])
worksheet.write(rownum+33,4,col[109])
worksheet.write(rownum+34,4,col[110])
worksheet.write(rownum+35,4,col[111])
worksheet.write(rownum+36,4,col[112])
worksheet.write(rownum+37,4,col[113])
worksheet.write(rownum+38,4,col[114])
worksheet.write(rownum+39,4,col[115])
worksheet.write(rownum+40,4,col[116])
worksheet.write(rownum+41,4,col[117])
worksheet.write(rownum+42,4,col[118])
worksheet.write(rownum+43,4,col[119])
worksheet.write(rownum+44,4,col[120])
worksheet.write(rownum+45,4,col[121])
worksheet.write(rownum+46,4,col[122])
worksheet.write(rownum+47,4,col[123])
worksheet.write(rownum+48,4,col[124])
worksheet.write(rownum+49,4,col[125])
worksheet.write(rownum+50,4,col[126])
worksheet.write(rownum+51,4,col[127])
worksheet.write(rownum+52,4,col[128])
worksheet.write(rownum+53,4,col[129])
worksheet.write(rownum+54,4,col[130])
worksheet.write(rownum+55,4,col[131])
worksheet.write(rownum+56,4,col[132])
worksheet.write(rownum+57,4,col[133])
worksheet.write(rownum+58,4,col[134])
worksheet.write(rownum+59,4,col[135])
worksheet.write(rownum+60,4,col[136])
worksheet.write(rownum+61,4,col[137])
worksheet.write(rownum+62,4,col[138])
worksheet.write(rownum+63,4,col[139])
worksheet.write(rownum+64,4,col[140])
worksheet.write(rownum+65,4,col[141])
worksheet.write(rownum+66,4,col[142])
worksheet.write(rownum+67,4,col[143])
worksheet.write(rownum+68,4,col[144])
worksheet.write(rownum+69,4,col[145])
worksheet.write(rownum+70,4,col[146])
worksheet.write(rownum+71,4,col[147])
worksheet.write(rownum+72,4,col[148])
worksheet.write(rownum+73,4,col[149])
worksheet.write(rownum+74,4,col[150])
worksheet.write(rownum+75,4,col[151])
worksheet.write(rownum+76,4,col[152])
worksheet.write(rownum+77,4,col[153])

#Not Available

worksheet.write(rownum+1,5,col[154])
worksheet.write(rownum+2,5,col[155])
worksheet.write(rownum+3,5,col[156])
worksheet.write(rownum+4,5,col[157])
worksheet.write(rownum+5,5,col[158])
worksheet.write(rownum+6,5,col[159])
worksheet.write(rownum+7,5,col[160])
worksheet.write(rownum+8,5,col[161])
worksheet.write(rownum+9,5,col[162])
worksheet.write(rownum+10,5,col[163])
worksheet.write(rownum+11,5,col[164])
worksheet.write(rownum+12,5,col[165])
worksheet.write(rownum+13,5,col[166])
worksheet.write(rownum+14,5,col[167])
worksheet.write(rownum+15,5,col[168])
worksheet.write(rownum+16,5,col[169])
worksheet.write(rownum+17,5,col[170])
worksheet.write(rownum+18,5,col[171])
worksheet.write(rownum+19,5,col[172])
worksheet.write(rownum+20,5,col[173])
worksheet.write(rownum+21,5,col[174])
worksheet.write(rownum+22,5,col[175])
worksheet.write(rownum+23,5,col[176])
worksheet.write(rownum+24,5,col[177])
worksheet.write(rownum+25,5,col[178])
worksheet.write(rownum+26,5,col[179])
worksheet.write(rownum+27,5,col[180])
worksheet.write(rownum+28,5,col[181])
worksheet.write(rownum+29,5,col[182])
worksheet.write(rownum+30,5,col[183])
worksheet.write(rownum+31,5,col[184])
worksheet.write(rownum+32,5,col[185])
worksheet.write(rownum+33,5,col[186])
worksheet.write(rownum+34,5,col[187])
worksheet.write(rownum+35,5,col[188])
worksheet.write(rownum+36,5,col[189])
worksheet.write(rownum+37,5,col[190])
worksheet.write(rownum+38,5,col[191])
worksheet.write(rownum+39,5,col[192])
worksheet.write(rownum+40,5,col[193])
worksheet.write(rownum+41,5,col[194])
worksheet.write(rownum+42,5,col[195])
worksheet.write(rownum+43,5,col[196])
worksheet.write(rownum+44,5,col[197])
worksheet.write(rownum+45,5,col[198])
worksheet.write(rownum+46,5,col[199])
worksheet.write(rownum+47,5,col[200])
worksheet.write(rownum+48,5,col[201])
worksheet.write(rownum+49,5,col[202])
worksheet.write(rownum+50,5,col[203])
worksheet.write(rownum+51,5,col[204])
worksheet.write(rownum+52,5,col[205])
worksheet.write(rownum+53,5,col[206])
worksheet.write(rownum+54,5,col[207])
worksheet.write(rownum+55,5,col[208])
worksheet.write(rownum+56,5,col[209])
worksheet.write(rownum+57,5,col[210])
worksheet.write(rownum+58,5,col[211])
worksheet.write(rownum+59,5,col[212])
worksheet.write(rownum+60,5,col[213])
worksheet.write(rownum+61,5,col[214])
worksheet.write(rownum+62,5,col[215])
worksheet.write(rownum+63,5,col[216])
worksheet.write(rownum+64,5,col[217])
worksheet.write(rownum+65,5,col[218])
worksheet.write(rownum+66,5,col[219])
worksheet.write(rownum+67,5,col[220])
worksheet.write(rownum+68,5,col[221])
worksheet.write(rownum+69,5,col[222])
worksheet.write(rownum+70,5,col[223])
worksheet.write(rownum+71,5,col[224])
worksheet.write(rownum+72,5,col[225])
worksheet.write(rownum+73,5,col[226])
worksheet.write(rownum+74,5,col[227])
worksheet.write(rownum+75,5,col[228])
worksheet.write(rownum+76,5,col[229])
worksheet.write(rownum+77,5,col[230])

#Total Not On Shelf
worksheet.write_formula('G2', "=SUM(E2:F2)", )
worksheet.write_formula('G3', "=SUM(E3:F3)", )
worksheet.write_formula('G4', "=SUM(E4:F4)", )
worksheet.write_formula('G5', "=SUM(E5:F5)", )
worksheet.write_formula('G6', "=SUM(E6:F6)", )
worksheet.write_formula('G7', "=SUM(E7:F7)", )
worksheet.write_formula('G8', "=SUM(E8:F8)", )
worksheet.write_formula('G9', "=SUM(E9:F9)", )
worksheet.write_formula('G10', "=SUM(E10:F10)", )
worksheet.write_formula('G11', "=SUM(E11:F11)", )
worksheet.write_formula('G12', "=SUM(E12:F12)", )
worksheet.write_formula('G13', "=SUM(E13:F13)", )
worksheet.write_formula('G14', "=SUM(E14:F14)", )
worksheet.write_formula('G15', "=SUM(E15:F15)", )
worksheet.write_formula('G16', "=SUM(E16:F16)", )
worksheet.write_formula('G17', "=SUM(E17:F17)", )
worksheet.write_formula('G18', "=SUM(E18:F18)", )
worksheet.write_formula('G19', "=SUM(E19:F19)", )
worksheet.write_formula('G20', "=SUM(E20:F20)", )
worksheet.write_formula('G21', "=SUM(E21:F21)", )
worksheet.write_formula('G22', "=SUM(E22:F22)", )
worksheet.write_formula('G23', "=SUM(E23:F23)", )
worksheet.write_formula('G24', "=SUM(E24:F24)", )
worksheet.write_formula('G25', "=SUM(E25:F25)", )
worksheet.write_formula('G26', "=SUM(E26:F26)", )
worksheet.write_formula('G27', "=SUM(E27:F27)", )
worksheet.write_formula('G28', "=SUM(E28:F28)", )
worksheet.write_formula('G29', "=SUM(E29:F29)", )
worksheet.write_formula('G30', "=SUM(E30:F30)", )
worksheet.write_formula('G31', "=SUM(E31:F31)", )
worksheet.write_formula('G32', "=SUM(E32:F32)", )
worksheet.write_formula('G33', "=SUM(E33:F33)", )
worksheet.write_formula('G34', "=SUM(E34:F34)", )
worksheet.write_formula('G35', "=SUM(E35:F35)", )
worksheet.write_formula('G36', "=SUM(E36:F36)", )
worksheet.write_formula('G37', "=SUM(E37:F37)", )
worksheet.write_formula('G38', "=SUM(E38:F38)", )
worksheet.write_formula('G39', "=SUM(E39:F39)", )
worksheet.write_formula('G40', "=SUM(E40:F40)", )
worksheet.write_formula('G41', "=SUM(E41:F41)", )
worksheet.write_formula('G42', "=SUM(E42:F42)", )
worksheet.write_formula('G43', "=SUM(E43:F43)", )
worksheet.write_formula('G44', "=SUM(E44:F44)", )
worksheet.write_formula('G45', "=SUM(E45:F45)", )
worksheet.write_formula('G46', "=SUM(E46:F46)", )
worksheet.write_formula('G47', "=SUM(E47:F47)", )
worksheet.write_formula('G48', "=SUM(E48:F48)", )
worksheet.write_formula('G49', "=SUM(E49:F49)", )
worksheet.write_formula('G50', "=SUM(E50:F50)", )
worksheet.write_formula('G51', "=SUM(E51:F51)", )
worksheet.write_formula('G52', "=SUM(E52:F52)", )
worksheet.write_formula('G53', "=SUM(E53:F53)", )
worksheet.write_formula('G54', "=SUM(E54:F54)", )
worksheet.write_formula('G55', "=SUM(E55:F55)", )
worksheet.write_formula('G56', "=SUM(E56:F56)", )
worksheet.write_formula('G57', "=SUM(E57:F57)", )
worksheet.write_formula('G58', "=SUM(E58:F58)", )
worksheet.write_formula('G59', "=SUM(E59:F59)", )
worksheet.write_formula('G60', "=SUM(E60:F60)", )
worksheet.write_formula('G61', "=SUM(E61:F61)", )
worksheet.write_formula('G62', "=SUM(E62:F62)", )
worksheet.write_formula('G63', "=SUM(E63:F63)", )
worksheet.write_formula('G64', "=SUM(E64:F64)", )
worksheet.write_formula('G65', "=SUM(E65:F65)", )
worksheet.write_formula('G66', "=SUM(E66:F66)", )
worksheet.write_formula('G67', "=SUM(E67:F67)", )
worksheet.write_formula('G68', "=SUM(E68:F68)", )
worksheet.write_formula('G69', "=SUM(E69:F69)", )
worksheet.write_formula('G70', "=SUM(E70:F70)", )
worksheet.write_formula('G71', "=SUM(E71:F71)", )
worksheet.write_formula('G72', "=SUM(E72:F72)", )
worksheet.write_formula('G73', "=SUM(E73:F73)", )
worksheet.write_formula('G74', "=SUM(E74:F74)", )
worksheet.write_formula('G75', "=SUM(E75:F75)", )
worksheet.write_formula('G76', "=SUM(E76:F76)", )
worksheet.write_formula('G77', "=SUM(E77:F77)", )
worksheet.write_formula('G78', "=SUM(E78:F78)", )

#%not on shelf

worksheet.write_formula('H2', "=G2/C2", percent_fmt)
worksheet.write_formula('H3', "=G3/C3", data_format3)
worksheet.write_formula('H4', "=G4/C4", percent_fmt)
worksheet.write_formula('H5', "=G5/C5", data_format3)
worksheet.write_formula('H6', "=G6/C6", percent_fmt)
worksheet.write_formula('H7', "=G7/C7", data_format3)
worksheet.write_formula('H8', "=G8/C8", percent_fmt)
worksheet.write_formula('H9', "=G9/C9", data_format3)
worksheet.write_formula('H10', "=G10/C10", percent_fmt)
worksheet.write_formula('H11', "=G11/C11", data_format3)
worksheet.write_formula('H12', "=G12/C12", percent_fmt)
worksheet.write_formula('H13', "=G13/C13", data_format3)
worksheet.write_formula('H14', "=G14/C14", percent_fmt)
worksheet.write_formula('H15', "=G15/C15", data_format3)
worksheet.write_formula('H16', "=G16/C16", percent_fmt)
worksheet.write_formula('H17', "=G17/C17", data_format3)
worksheet.write_formula('H18', "=G18/C18", percent_fmt)
worksheet.write_formula('H19', "=G19/C19", data_format3)
worksheet.write_formula('H20', "=G20/C20", percent_fmt)
worksheet.write_formula('H21', "=G21/C21", data_format3)
worksheet.write_formula('H22', "=G22/C22", percent_fmt)
worksheet.write_formula('H23', "=G23/C23", data_format3)
worksheet.write_formula('H24', "=G24/C24", percent_fmt)
worksheet.write_formula('H25', "=G25/C25", data_format3)
worksheet.write_formula('H26', "=G26/C26", percent_fmt)
worksheet.write_formula('H27', "=G27/C27", data_format3)
worksheet.write_formula('H28', "=G28/C28", percent_fmt)
worksheet.write_formula('H29', "=G29/C29", data_format3)
worksheet.write_formula('H30', "=G30/C30", percent_fmt)
worksheet.write_formula('H31', "=G31/C31", data_format3)
worksheet.write_formula('H32', "=G32/C32", percent_fmt)
worksheet.write_formula('H33', "=G33/C33", data_format3)
worksheet.write_formula('H34', "=G34/C34", percent_fmt)
worksheet.write_formula('H35', "=G35/C35", data_format3)
worksheet.write_formula('H36', "=G36/C36", percent_fmt)
worksheet.write_formula('H37', "=G37/C37", data_format3)
worksheet.write_formula('H38', "=G38/C38", percent_fmt)
worksheet.write_formula('H39', "=G39/C39", data_format3)
worksheet.write_formula('H40', "=G40/C40", percent_fmt)
worksheet.write_formula('H41', "=G41/C41", data_format3)
worksheet.write_formula('H42', "=G42/C42", percent_fmt)
worksheet.write_formula('H43', "=G43/C43", data_format3)
worksheet.write_formula('H44', "=G44/C44", percent_fmt)
worksheet.write_formula('H45', "=G45/C45", data_format3)
worksheet.write_formula('H46', "=G46/C46", percent_fmt)
worksheet.write_formula('H47', "=G47/C47", data_format3)
worksheet.write_formula('H48', "=G48/C48", percent_fmt)
worksheet.write_formula('H49', "=G49/C49", data_format3)
worksheet.write_formula('H50', "=G50/C50", percent_fmt)
worksheet.write_formula('H51', "=G51/C51", data_format3)
worksheet.write_formula('H52', "=G52/C52", percent_fmt)
worksheet.write_formula('H53', "=G53/C53", data_format3)
worksheet.write_formula('H54', "=G54/C54", percent_fmt)
worksheet.write_formula('H55', "=G55/C55", data_format3)
worksheet.write_formula('H56', "=G56/C56", percent_fmt)
worksheet.write_formula('H57', "=G57/C57", data_format3)
worksheet.write_formula('H58', "=G58/C58", percent_fmt)
worksheet.write_formula('H59', "=G59/C59", data_format3)
worksheet.write_formula('H60', "=G60/C60", percent_fmt)
worksheet.write_formula('H61', "=G61/C61", data_format3)
worksheet.write_formula('H62', "=G62/C62", percent_fmt)
worksheet.write_formula('H63', "=G63/C63", data_format3)
worksheet.write_formula('H64', "=G64/C64", percent_fmt)
worksheet.write_formula('H65', "=G65/C65", data_format3)
worksheet.write_formula('H66', "=G66/C66", percent_fmt)
worksheet.write_formula('H67', "=G67/C67", data_format3)
worksheet.write_formula('H68', "=G68/C68", percent_fmt)
worksheet.write_formula('H69', "=G69/C69", data_format3)
worksheet.write_formula('H70', "=G70/C70", percent_fmt)
worksheet.write_formula('H71', "=G71/C71", data_format3)
worksheet.write_formula('H72', "=G72/C72", percent_fmt)
worksheet.write_formula('H73', "=G73/C73", data_format3)
worksheet.write_formula('H74', "=G74/C74", percent_fmt)
worksheet.write_formula('H75', "=G75/C75", data_format3)
worksheet.write_formula('H76', "=G76/C76", percent_fmt)
worksheet.write_formula('H77', "=G77/C77", data_format3)
worksheet.write_formula('H78', "=G78/C78", percent_fmt)


#Total on Shelf

worksheet.write_formula('I2', "=C2-G2", )
worksheet.write_formula('I3', "=C3-G3", )
worksheet.write_formula('I4', "=C4-G4", )
worksheet.write_formula('I5', "=C5-G5", )
worksheet.write_formula('I6', "=C6-G6", )
worksheet.write_formula('I7', "=C7-G7", )
worksheet.write_formula('I8', "=C8-G8", )
worksheet.write_formula('I9', "=C9-G9", )
worksheet.write_formula('I10', "=C10-G10", )
worksheet.write_formula('I11', "=C11-G11", )
worksheet.write_formula('I12', "=C12-G12", )
worksheet.write_formula('I13', "=C13-G13", )
worksheet.write_formula('I14', "=C14-G14", )
worksheet.write_formula('I15', "=C15-G15", )
worksheet.write_formula('I16', "=C16-G16", )
worksheet.write_formula('I17', "=C17-G17", )
worksheet.write_formula('I18', "=C18-G18", )
worksheet.write_formula('I19', "=C19-G19", )
worksheet.write_formula('I20', "=C20-G20", )
worksheet.write_formula('I21', "=C21-G21", )
worksheet.write_formula('I22', "=C22-G22", )
worksheet.write_formula('I23', "=C23-G23", )
worksheet.write_formula('I24', "=C24-G24", )
worksheet.write_formula('I25', "=C25-G25", )
worksheet.write_formula('I26', "=C26-G26", )
worksheet.write_formula('I27', "=C27-G27", )
worksheet.write_formula('I28', "=C28-G28", )
worksheet.write_formula('I29', "=C29-G29", )
worksheet.write_formula('I30', "=C30-G30", )
worksheet.write_formula('I31', "=C31-G31", )
worksheet.write_formula('I32', "=C32-G32", )
worksheet.write_formula('I33', "=C33-G33", )
worksheet.write_formula('I34', "=C34-G34", )
worksheet.write_formula('I35', "=C35-G35", )
worksheet.write_formula('I36', "=C36-G36", )
worksheet.write_formula('I37', "=C37-G37", )
worksheet.write_formula('I38', "=C38-G38", )
worksheet.write_formula('I39', "=C39-G39", )
worksheet.write_formula('I40', "=C40-G40", )
worksheet.write_formula('I41', "=C41-G41", )
worksheet.write_formula('I42', "=C42-G42", )
worksheet.write_formula('I43', "=C43-G43", )
worksheet.write_formula('I44', "=C44-G44", )
worksheet.write_formula('I45', "=C45-G45", )
worksheet.write_formula('I46', "=C46-G46", )
worksheet.write_formula('I47', "=C47-G47", )
worksheet.write_formula('I48', "=C48-G48", )
worksheet.write_formula('I49', "=C49-G49", )
worksheet.write_formula('I50', "=C50-G50", )
worksheet.write_formula('I51', "=C51-G51", )
worksheet.write_formula('I52', "=C52-G52", )
worksheet.write_formula('I53', "=C53-G53", )
worksheet.write_formula('I54', "=C54-G54", )
worksheet.write_formula('I55', "=C55-G55", )
worksheet.write_formula('I56', "=C56-G56", )
worksheet.write_formula('I57', "=C57-G57", )
worksheet.write_formula('I58', "=C58-G58", )
worksheet.write_formula('I59', "=C59-G59", )
worksheet.write_formula('I60', "=C60-G60", )
worksheet.write_formula('I61', "=C61-G61", )
worksheet.write_formula('I62', "=C62-G62", )
worksheet.write_formula('I63', "=C63-G63", )
worksheet.write_formula('I64', "=C64-G64", )
worksheet.write_formula('I65', "=C65-G65", )
worksheet.write_formula('I66', "=C66-G66", )
worksheet.write_formula('I67', "=C67-G67", )
worksheet.write_formula('I68', "=C68-G68", )
worksheet.write_formula('I69', "=C69-G69", )
worksheet.write_formula('I70', "=C70-G70", )
worksheet.write_formula('I71', "=C71-G71", )
worksheet.write_formula('I72', "=C72-G72", )
worksheet.write_formula('I73', "=C73-G73", )
worksheet.write_formula('I74', "=C74-G74", )
worksheet.write_formula('I75', "=C75-G75", )
worksheet.write_formula('I76', "=C76-G76", )
worksheet.write_formula('I77', "=C77-G77", )
worksheet.write_formula('I78', "=C78-G78", )

#Space Needed for target No- % off Shelf

worksheet.write_formula('J2', "=B2-(B2*H2)", decimal3)
worksheet.write_formula('J3', "=B3-(B3*H3)", decimal4)
worksheet.write_formula('J4', "=B4-(B4*H4)", decimal3)
worksheet.write_formula('J5', "=B5-(B5*H5)", decimal4)
worksheet.write_formula('J6', "=B6-(B6*H6)", decimal3)
worksheet.write_formula('J7', "=B7-(B7*H7)", decimal4)
worksheet.write_formula('J8', "=B8-(B8*H8)", decimal3)
worksheet.write_formula('J9', "=B9-(B9*H9)", decimal4)
worksheet.write_formula('J10', "=B10-(B10*H10)", decimal3)
worksheet.write_formula('J11', "=B11-(B11*H11)", decimal4)
worksheet.write_formula('J12', "=B12-(B12*H12)", decimal3)
worksheet.write_formula('J13', "=B13-(B13*H13)", decimal4)
worksheet.write_formula('J14', "=B14-(B14*H14)", decimal3)
worksheet.write_formula('J15', "=B15-(B15*H15)", decimal4)
worksheet.write_formula('J16', "=B16-(B16*H16)", decimal3)
worksheet.write_formula('J17', "=B17-(B17*H17)", decimal4)
worksheet.write_formula('J18', "=B18-(B18*H18)", decimal3)
worksheet.write_formula('J19', "=B19-(B19*H19)", decimal4)
worksheet.write_formula('J20', "=B20-(B20*H20)", decimal3)
worksheet.write_formula('J21', "=B21-(B21*H21)", decimal4)
worksheet.write_formula('J22', "=B22-(B22*H22)", decimal3)
worksheet.write_formula('J23', "=B23-(B23*H23)", decimal4)
worksheet.write_formula('J24', "=B24-(B24*H24)", decimal3)
worksheet.write_formula('J25', "=B25-(B25*H25)", decimal4)
worksheet.write_formula('J26', "=B26-(B26*H26)", decimal3)
worksheet.write_formula('J27', "=B27-(B27*H27)", decimal4)
worksheet.write_formula('J28', "=B28-(B28*H28)", decimal3)
worksheet.write_formula('J29', "=B29-(B29*H29)", decimal4)
worksheet.write_formula('J30', "=B30-(B30*H30)", decimal3)
worksheet.write_formula('J31', "=B31-(B31*H31)", decimal4)
worksheet.write_formula('J32', "=B32-(B32*H32)", decimal3)
worksheet.write_formula('J33', "=B33-(B33*H33)", decimal4)
worksheet.write_formula('J34', "=C34-(C34*H34)", decimal3)
worksheet.write_formula('J35', "=B35-(B35*H35)", decimal4)
worksheet.write_formula('J36', "=B36-(B36*H36)", decimal3)
worksheet.write_formula('J37', "=B37-(B37*H37)", decimal4)
worksheet.write_formula('J38', "=B38-(B38*H38)", decimal3)
worksheet.write_formula('J39', "=B39-(B39*H39)", decimal4)
worksheet.write_formula('J40', "=B40-(B40*H40)", decimal3)
worksheet.write_formula('J41', "=B41-(B41*H41)", decimal4)
worksheet.write_formula('J42', "=B42-(B42*H42)", decimal3)
worksheet.write_formula('J43', "=B43-(B43*H43)", decimal4)
worksheet.write_formula('J44', "=B44-(B44*H44)", decimal3)
worksheet.write_formula('J45', "=B45-(B45*H45)", decimal4)
worksheet.write_formula('J46', "=B46-(B46*H46)", decimal3)
worksheet.write_formula('J47', "=B47-(B47*H47)", decimal4)
worksheet.write_formula('J48', "=B48-(B48*H48)", decimal3)
worksheet.write_formula('J49', "=C49-(C49*H49)", decimal4)
worksheet.write_formula('J50', "=B50-(B50*H50)", decimal3)
worksheet.write_formula('J51', "=B51-(B51*H51)", decimal4)
worksheet.write_formula('J52', "=B52-(B52*H52)", decimal3)
worksheet.write_formula('J53', "=B53-(B53*H53)", decimal4)
worksheet.write_formula('J54', "=B54-(B54*H54)", decimal3)
worksheet.write_formula('J55', "=B55-(B55*H55)", decimal4)
worksheet.write_formula('J56', "=B56-(B56*H56)", decimal3)
worksheet.write_formula('J57', "=B57-(B57*H57)", decimal4)
worksheet.write_formula('J58', "=B58-(B58*H58)", decimal3)
worksheet.write_formula('J59', "=B59-(B59*H59)", decimal4)
worksheet.write_formula('J60', "=B60-(B60*H60)", decimal3)
worksheet.write_formula('J61', "=B61-(B61*H61)", decimal4)
worksheet.write_formula('J62', "=B62-(B62*H62)", decimal3)
worksheet.write_formula('J63', "=B63-(B63*H63)", decimal4)
worksheet.write_formula('J64', "=B64-(B64*H64)", decimal3)
worksheet.write_formula('J65', "=B65-(B65*H65)", decimal4)
worksheet.write_formula('J66', "=B66-(B66*H66)", decimal3)
worksheet.write_formula('J67', "=B67-(B67*H67)", decimal4)
worksheet.write_formula('J68', "=B68-(B68*H68)", decimal3)
worksheet.write_formula('J69', "=B69-(B69*H69)", decimal4)
worksheet.write_formula('J70', "=B70-(B70*H70)", decimal3)
worksheet.write_formula('J71', "=B71-(B71*H71)", decimal4)
worksheet.write_formula('J72', "=B72-(B72*H72)", decimal3)
worksheet.write_formula('J73', "=B73-(B73*H73)", decimal4)
worksheet.write_formula('J74', "=B74-(B74*H74)", decimal3)
worksheet.write_formula('J75', "=B75-(B75*H75)", decimal4)
worksheet.write_formula('J76', "=B76-(B76*H76)", decimal3)
worksheet.write_formula('J77', "=B77-(B77*H77)", decimal4)
worksheet.write_formula('J78', "=B78-(B78*H78)", decimal3)

#Items per shelf

worksheet.write(rownum+1,10,'24', eformatlabel2)
worksheet.write(rownum+2,10,'27', eformatlabel3)
worksheet.write(rownum+3,10,'28', eformatlabel2)
worksheet.write(rownum+4,10,'24', eformatlabel3)
worksheet.write(rownum+5,10,'25', eformatlabel2)
worksheet.write(rownum+6,10,'22', eformatlabel3)
worksheet.write(rownum+7,10,'25', eformatlabel2)
worksheet.write(rownum+8,10,'23', eformatlabel3)
worksheet.write(rownum+9,10,'24', eformatlabel2) 
worksheet.write(rownum+10,10,'26.4', eformatlabel3) 
worksheet.write(rownum+11,10,'28', eformatlabel2)
worksheet.write(rownum+12,10,'23', eformatlabel3) 
worksheet.write(rownum+13,10,'26', eformatlabel2) 
worksheet.write(rownum+14,10,'29', eformatlabel3)
worksheet.write(rownum+15,10,'36', eformatlabel2)
worksheet.write(rownum+16,10,'24', eformatlabel3)
worksheet.write(rownum+17,10,'28', eformatlabel2)
worksheet.write(rownum+18,10,'27', eformatlabel3)
worksheet.write(rownum+19,10,'22', eformatlabel2) 
worksheet.write(rownum+20,10,'31', eformatlabel3) 
worksheet.write(rownum+21,10,'24', eformatlabel2)
worksheet.write(rownum+22,10,'28', eformatlabel3)
worksheet.write(rownum+23,10,'27', eformatlabel2)
worksheet.write(rownum+24,10,'47', eformatlabel3)
worksheet.write(rownum+25,10,'23', eformatlabel2)
worksheet.write(rownum+26,10,'32', eformatlabel3)
worksheet.write(rownum+27,10,'24', eformatlabel2)
worksheet.write(rownum+28,10,'54', eformatlabel3)
worksheet.write(rownum+29,10,'32', eformatlabel2) 
worksheet.write(rownum+30,10,'25', eformatlabel3) 
worksheet.write(rownum+31,10,'21', eformatlabel2)
worksheet.write(rownum+32,10,'38', eformatlabel3)
worksheet.write(rownum+33,10,'30', eformatlabel2)
worksheet.write(rownum+34,10,'34', eformatlabel3)
worksheet.write(rownum+35,10,'26', eformatlabel2)
worksheet.write(rownum+36,10,'25.4', eformatlabel3)
worksheet.write(rownum+37,10,'29', eformatlabel2)
worksheet.write(rownum+38,10,'26', eformatlabel3)
worksheet.write(rownum+39,10,'35', eformatlabel2) 
worksheet.write(rownum+40,10,'50', eformatlabel3)
worksheet.write(rownum+41,10,'25', eformatlabel2)
worksheet.write(rownum+42,10,'25', eformatlabel3)
worksheet.write(rownum+43,10,'31', eformatlabel2)
worksheet.write(rownum+44,10,'22', eformatlabel3)
worksheet.write(rownum+45,10,'26', eformatlabel2)
worksheet.write(rownum+46,10,'24', eformatlabel3)
worksheet.write(rownum+47,10,'23', eformatlabel2)
worksheet.write(rownum+48,10,'25', eformatlabel3)
worksheet.write(rownum+49,10,'', eformatlabel2) 
worksheet.write(rownum+50,10,'45', eformatlabel3)
worksheet.write(rownum+51,10,'58', eformatlabel2)
worksheet.write(rownum+52,10,'23', eformatlabel3)
worksheet.write(rownum+53,10,'32', eformatlabel2)
worksheet.write(rownum+54,10,'24', eformatlabel3)
worksheet.write(rownum+55,10,'20', eformatlabel2) 
worksheet.write(rownum+56,10,'52', eformatlabel3) 
worksheet.write(rownum+57,10,'32', eformatlabel2)
worksheet.write(rownum+58,10,'24', eformatlabel3)
worksheet.write(rownum+59,10,'24.6', eformatlabel2)   
worksheet.write(rownum+60,10,'25', eformatlabel3)   
worksheet.write(rownum+61,10,'24', eformatlabel2) 
worksheet.write(rownum+62,10,'21', eformatlabel3)
worksheet.write(rownum+63,10,'20', eformatlabel2)
worksheet.write(rownum+64,10,'32', eformatlabel3)
worksheet.write(rownum+65,10,'24', eformatlabel2) 
worksheet.write(rownum+66,10,'23', eformatlabel3) 
worksheet.write(rownum+67,10,'24', eformatlabel2)
worksheet.write(rownum+68,10,'26', eformatlabel3)   
worksheet.write(rownum+69,10,'23', eformatlabel2)   
worksheet.write(rownum+70,10,'31', eformatlabel3)
worksheet.write(rownum+71,10,'26', eformatlabel2) 
worksheet.write(rownum+72,10,'26', eformatlabel3)
worksheet.write(rownum+73,10,'25', eformatlabel2)
worksheet.write(rownum+74,10,'37', eformatlabel3)
worksheet.write(rownum+75,10,'21.5', eformatlabel2)
worksheet.write(rownum+76,10,'25', eformatlabel3)
worksheet.write(rownum+77,10,'28', eformatlabel2)

#No of 35" shelves

worksheet.write_formula('L2', "=J2/K2", decimal)
worksheet.write_formula('L3', "=J3/K3", decimal1)
worksheet.write_formula('L4', "=J4/K4", decimal)
worksheet.write_formula('L5', "=J5/K5", decimal1)
worksheet.write_formula('L6', "=J6/K6", decimal)
worksheet.write_formula('L7', "=J7/K7", decimal1)
worksheet.write_formula('L8', "=J8/K8", decimal)
worksheet.write_formula('L9', "=J9/K9", decimal1)
worksheet.write_formula('L10', "=J10/K10", decimal)
worksheet.write_formula('L11', "=J11/K11", decimal1)
worksheet.write_formula('L12', "=J12/K12", decimal)
worksheet.write_formula('L13', "=J13/K13", decimal1)
worksheet.write_formula('L14', "=J14/K14", decimal)
worksheet.write_formula('L15', "=J15/K15", decimal1)
worksheet.write_formula('L16', "=J16/K16", decimal)
worksheet.write_formula('L17', "=J17/K17", decimal1)
worksheet.write_formula('L18', "=J18/K18", decimal)
worksheet.write_formula('L19', "=J19/K19", decimal1)
worksheet.write_formula('L20', "=J20/K20", decimal)
worksheet.write_formula('L21', "=J21/K21", decimal1)
worksheet.write_formula('L22', "=J22/K22", decimal)
worksheet.write_formula('L23', "=J23/K23", decimal1)
worksheet.write_formula('L24', "=J24/K24", decimal)
worksheet.write_formula('L25', "=J25/K25", decimal1)
worksheet.write_formula('L26', "=J26/K26", decimal)
worksheet.write_formula('L27', "=J27/K27", decimal1)
worksheet.write_formula('L28', "=J28/K28", decimal)
worksheet.write_formula('L29', "=J29/K29", decimal1)
worksheet.write_formula('L30', "=J30/K30", decimal)
worksheet.write_formula('L31', "=J31/K31", decimal1)
worksheet.write_formula('L32', "=J32/K32", decimal)
worksheet.write_formula('L33', "=J33/K33", decimal1)
worksheet.write_formula('L34', "=J34/K34", decimal)
worksheet.write_formula('L35', "=J35/K35", decimal1)
worksheet.write_formula('L36', "=J36/K36", decimal)
worksheet.write_formula('L37', "=J37/K37", decimal1)
worksheet.write_formula('L38', "=J38/K38", decimal)
worksheet.write_formula('L39', "=J39/K39", decimal1)
worksheet.write_formula('L40', "=J40/K40", decimal)
worksheet.write_formula('L41', "=J41/K41", decimal1)
worksheet.write_formula('L42', "=J42/K42", decimal)
worksheet.write_formula('L43', "=J43/K43", decimal1)
worksheet.write_formula('L44', "=J44/K44", decimal)
worksheet.write_formula('L45', "=J45/K45", decimal1)
worksheet.write_formula('L46', "=J46/K46", decimal)
worksheet.write_formula('L47', "=J47/K47", decimal1)
worksheet.write_formula('L48', "=J48/K48", decimal)
worksheet.write_formula('L49', "=J49/K49", decimal1)
worksheet.write_formula('L50', "=J50/K50", decimal)
worksheet.write_formula('L51', "=J51/K51", decimal1)
worksheet.write_formula('L52', "=J52/K52", decimal)
worksheet.write_formula('L53', "=J53/K53", decimal1)
worksheet.write_formula('L54', "=J54/K54", decimal)
worksheet.write_formula('L55', "=J55/K55", decimal1)
worksheet.write_formula('L56', "=J56/K56", decimal)
worksheet.write_formula('L57', "=J57/K57", decimal1)
worksheet.write_formula('L58', "=J58/K58", decimal)
worksheet.write_formula('L59', "=J59/K59", decimal1)
worksheet.write_formula('L60', "=J60/K60", decimal)
worksheet.write_formula('L61', "=J61/K61", decimal1)
worksheet.write_formula('L62', "=J62/K62", decimal)
worksheet.write_formula('L63', "=J63/K63", decimal1)
worksheet.write_formula('L64', "=J64/K64", decimal)
worksheet.write_formula('L65', "=J65/K65", decimal1)
worksheet.write_formula('L66', "=J66/K66", decimal)
worksheet.write_formula('L67', "=J67/K67", decimal1)
worksheet.write_formula('L68', "=J68/K68", decimal)
worksheet.write_formula('L69', "=J69/K69", decimal1)
worksheet.write_formula('L70', "=J70/K70", decimal)
worksheet.write_formula('L71', "=J71/K71", decimal1)
worksheet.write_formula('L72', "=J72/K72", decimal)
worksheet.write_formula('L73', "=J73/K73", decimal1)
worksheet.write_formula('L74', "=J74/K74", decimal)
worksheet.write_formula('L75', "=J75/K75", decimal1)
worksheet.write_formula('L76', "=J76/K76", decimal)
worksheet.write_formula('L77', "=J77/K77", decimal1)
worksheet.write_formula('L78', "=J78/K78", decimal)

#tOTAL liNEAR FEET


worksheet.write_formula('M2', "=(L2*35)/12", decimal)
worksheet.write_formula('M3', "=(L3*35)/12", decimal1)
worksheet.write_formula('M4', "=(L4*35)/12", decimal)
worksheet.write_formula('M5', "=(L5*35)/12", decimal1)
worksheet.write_formula('M6', "=(L6*35)/12", decimal)
worksheet.write_formula('M7', "=(L7*35)/12", decimal1)
worksheet.write_formula('M8', "=(L8*35)/12", decimal)
worksheet.write_formula('M9', "=(L9*35)/12", decimal1)
worksheet.write_formula('M10', "=(L10*35)/12", decimal)
worksheet.write_formula('M11', "=(L11*35)/12", decimal1)
worksheet.write_formula('M12', "=(L12*35)/12", decimal)
worksheet.write_formula('M13', "=(L13*35)/12", decimal1)
worksheet.write_formula('M14', "=(L14*35)/12", decimal)
worksheet.write_formula('M15', "=(L15*35)/12", decimal1)
worksheet.write_formula('M16', "=(L16*35)/12", decimal)
worksheet.write_formula('M17', "=(L17*35)/12", decimal1)
worksheet.write_formula('M18', "=(L18*35)/12", decimal)
worksheet.write_formula('M19', "=(L19*35)/12", decimal1)
worksheet.write_formula('M20', "=(L20*35)/12", decimal)
worksheet.write_formula('M21', "=(L21*35)/12", decimal1)
worksheet.write_formula('M22', "=(L22*35)/12", decimal)
worksheet.write_formula('M23', "=(L23*35)/12", decimal1)
worksheet.write_formula('M24', "=(L24*35)/12", decimal)
worksheet.write_formula('M25', "=(L25*35)/12", decimal1)
worksheet.write_formula('M26', "=(L26*35)/12", decimal)
worksheet.write_formula('M27', "=(L27*35)/12", decimal1)
worksheet.write_formula('M28', "=(L28*35)/12", decimal)
worksheet.write_formula('M29', "=(L29*35)/12", decimal1)
worksheet.write_formula('M30', "=(L30*35)/12", decimal)
worksheet.write_formula('M31', "=(L31*35)/12", decimal1)
worksheet.write_formula('M32', "=(L32*35)/12", decimal)
worksheet.write_formula('M33', "=(L33*35)/12", decimal1)
worksheet.write_formula('M34', "=(L34*35)/12", decimal)
worksheet.write_formula('M35', "=(L35*35)/12", decimal1)
worksheet.write_formula('M36', "=(L36*35)/12", decimal)
worksheet.write_formula('M37', "=(L37*35)/12", decimal1)
worksheet.write_formula('M38', "=(L38*35)/12", decimal)
worksheet.write_formula('M39', "=(L39*35)/12", decimal1)
worksheet.write_formula('M40', "=(L40*35)/12", decimal)
worksheet.write_formula('M41', "=(L41*35)/12", decimal1)
worksheet.write_formula('M42', "=(L42*35)/12", decimal)
worksheet.write_formula('M43', "=(L43*35)/12", decimal1)
worksheet.write_formula('M44', "=(L44*35)/12", decimal)
worksheet.write_formula('M45', "=(L45*35)/12", decimal1)
worksheet.write_formula('M46', "=(L46*35)/12", decimal)
worksheet.write_formula('M47', "=(L47*35)/12", decimal1)
worksheet.write_formula('M48', "=(L48*35)/12", decimal)
worksheet.write_formula('M49', "=(L49*35)/12", decimal1)
worksheet.write_formula('M50', "=(L50*35)/12", decimal)
worksheet.write_formula('M51', "=(L51*35)/12", decimal1)
worksheet.write_formula('M52', "=(L52*35)/12", decimal)
worksheet.write_formula('M53', "=(L53*35)/12", decimal1)
worksheet.write_formula('M54', "=(L54*35)/12", decimal)
worksheet.write_formula('M55', "=(L55*35)/12", decimal1)
worksheet.write_formula('M56', "=(L56*35)/12", decimal)
worksheet.write_formula('M57', "=(L57*35)/12", decimal1)
worksheet.write_formula('M58', "=(L58*35)/12", decimal)
worksheet.write_formula('M59', "=(L59*35)/12", decimal1)
worksheet.write_formula('M60', "=(L60*35)/12", decimal)
worksheet.write_formula('M61', "=(L61*35)/12", decimal1)
worksheet.write_formula('M62', "=(L62*35)/12", decimal)
worksheet.write_formula('M63', "=(L63*35)/12", decimal1)
worksheet.write_formula('M64', "=(L64*35)/12", decimal)
worksheet.write_formula('M65', "=(L65*35)/12", decimal1)
worksheet.write_formula('M66', "=(L66*35)/12", decimal)
worksheet.write_formula('M67', "=(L67*35)/12", decimal1)
worksheet.write_formula('M68', "=(L68*35)/12", decimal)
worksheet.write_formula('M69', "=(L69*35)/12", decimal1)
worksheet.write_formula('M70', "=(L70*35)/12", decimal)
worksheet.write_formula('M71', "=(L71*35)/12", decimal1)
worksheet.write_formula('M72', "=(L72*35)/12", decimal)
worksheet.write_formula('M73', "=(L73*35)/12", decimal1)
worksheet.write_formula('M74', "=(L74*35)/12", decimal)
worksheet.write_formula('M75', "=(L75*35)/12", decimal1)
worksheet.write_formula('M76', "=(L76*35)/12", decimal)
worksheet.write_formula('M77', "=(L77*35)/12", decimal1)
worksheet.write_formula('M78', "=(L78*35)/12", decimal)


workbook.close()

#Creating the email message
msg = MIMEMultipart()
msg['From'] = emailfrom
if type(emailto) is list:
    msg['To'] = ','.join(emailto)
else:
    msg['To'] = emailto
msg['Date'] = formatdate(localtime = True)
msg['Subject'] = emailsubject
msg.attach (MIMEText(emailmessage))
part = MIMEBase('application', "octet-stream")
part.set_payload(open(excelfile,"rb").read())
encoders.encode_base64(part)
part.add_header('Content-Disposition','attachment; filename=%s' % excelfile)
msg.attach(part)

#Sending the email message
smtp = smtplib.SMTP(emailhost, emailport)
smtp.sendmail(emailfrom, emailto, msg.as_string())
smtp.quit()








